{
  "vulns": [
    {
      "id": "GHSA-6jj6-gm7p-fcvv",
      "summary": "Remote Code Execution (RCE) vulnerability in geoserver",
      "details": "### Summary\nMultiple OGC request parameters allow Remote Code Execution (RCE) by unauthenticated users through specially crafted input against a default GeoServer installation due to unsafely evaluating property names as XPath expressions.\n\n### Details\nThe GeoTools library API that GeoServer calls evaluates property/attribute names for feature types in a way that unsafely passes them to the commons-jxpath library which can execute arbitrary code when evaluating XPath expressions. This XPath evaluation is intended to be used only by complex feature types (i.e., Application Schema data stores) but is incorrectly being applied to simple feature types as well which makes this vulnerability apply to **ALL** GeoServer instances.\n\n### PoC\nNo public PoC is provided but this vulnerability has been confirmed to be exploitable through WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic and WPS Execute requests.\n\n### Impact\nThis vulnerability can lead to executing arbitrary code.\n\n### Workaround\n\nA workaround exists by removing the `gt-complex-x.y.jar` file from the GeoServer where `x.y` is the GeoTools version (e.g., `gt-complex-31.1.jar` if running GeoServer 2.25.1). This will remove the vulnerable code from GeoServer but may break some GeoServer functionality or prevent GeoServer from deploying if the gt-complex module is needed by an extension you are using:\n\nMitigation for `geoserver.war` deploy:\n\n1. Stop the application server\n2. Unzip `geoserver.war` into a directory\n3. Locate the file `WEB-INF/lib/gt-complex-x.y.jar` and remove\n4. Zip the directory into a new `geoserver.war`\n5. Restart the application server\n\nMitigation for GeoServer binary:\n\n1. Stop Jetty\n2. Locate the file `webapps/geoserver/WEB-INF/lib/gt-complex-x.y.jar` and remove\n3. Restart Jetty\n\nThe following extensions and community modules are known to have a direct dependency on `gt-complex` jar and are not expected function properly without it. This is not comprehensive list and additional GeoServer functionality may be dependent on the availability of `gt-complex` jar:\n* Extensions: Application Schema, Catalog Services for the Web, MongoDB Data Store\n* Community Modules: Features-Templating, OGC API Modules, Smart Data Loader, SOLR Data Store\n\nMitigation available for prior releases patching three jars in your existing install:\n\n1. Patched `gt-app-schema`, `gt-complex` and `gt-xsd-core` jars may be downloaded for GeoServer: [2.25.1](https://sourceforge.net/projects/geoserver/files/GeoServer/2.25.1/geoserver-2.25.1-patches.zip/download), [2.24.3](https://sourceforge.net/projects/geoserver/files/GeoServer/2.24.3/geoserver-2.24.3-patches.zip/download), [2.24.2](https://sourceforge.net/projects/geoserver/files/GeoServer/2.24.2/geoserver-2.24.2-patches.zip/download), [2.23.2](https://sourceforge.net/projects/geoserver/files/GeoServer/2.23.2/geoserver-2.23.2-patches.zip/download), [2.22.2](https://sourceforge.net/projects/geoserver/files/GeoServer/2.22.2/geoserver-2.22.2-patches.zip/download), [2.21.5](https://sourceforge.net/projects/geoserver/files/GeoServer/2.21.5/geoserver-2.21.5-patches.zip/download), [2.21.4](https://sourceforge.net/projects/geoserver/files/GeoServer/2.21.4/geoserver-2.21.4-patches.zip/download),[2.20.7](https://sourceforge.net/projects/geoserver/files/GeoServer/2.20.7/geoserver-2.20.7-patches.zip/download), [2.20.4](https://sourceforge.net/projects/geoserver/files/GeoServer/2.20.4/geoserver-2.20.4-patches.zip/download), [2.19.2](https://sourceforge.net/projects/geoserver/files/GeoServer/2.19.2/geoserver-2.19.2-patches.zip/download), [2.18.0](https://sourceforge.net/projects/geoserver/files/GeoServer/2.18.0/geoserver-2.18.0-patches.zip/download).\n  \n   As example the 2.25.1 page links to [geoserver-2.25.1-patches.zip](https://sourceforge.net/projects/geoserver/files/GeoServer/2.25.1/geoserver-2.25.1-patches.zip/download) download on source forge.\n\n2. Unzip the `geoserver-x.y.z-patches.zip` which contains three jars that have been patched to configure `commons-jxpath` with an empty function list prior to use. These files are drop-in replacements with identical file names to those they are replacing.\n\n3. Follow the instructions above to locate `WEB-INF/lib` folder and replace the existing `gt-app-schema`, `gt-complex` and `gt-xsd-core` jars with those supplied by the patch.\n\n### References\nhttps://github.com/geotools/geotools/security/advisories/GHSA-w3pj-wh35-fq8w\nhttps://osgeo-org.atlassian.net/browse/GEOT-7587\nhttps://github.com/geotools/geotools/pull/4797\nhttps://github.com/Warxim/CVE-2022-41852?tab=readme-ov-file#workaround-for-cve-2022-41852",
      "aliases": [
        "CVE-2024-36401",
        "CVE-2024-36404",
        "GHSA-w3pj-wh35-fq8w"
      ],
      "modified": "2024-07-09T21:42:28Z",
      "published": "2024-07-01T20:34:50Z",
      "database_specific": {
        "github_reviewed_at": "2024-07-01T20:34:50Z",
        "github_reviewed": true,
        "severity": "CRITICAL",
        "cwe_ids": [
          "CWE-94",
          "CWE-95"
        ],
        "nvd_published_at": "2024-07-01T16:15:04Z"
      },
      "references": [
        {
          "type": "WEB",
          "url": "https://github.com/geoserver/geoserver/security/advisories/GHSA-6jj6-gm7p-fcvv"
        },
        {
          "type": "WEB",
          "url": "https://github.com/geotools/geotools/security/advisories/GHSA-w3pj-wh35-fq8w"
        },
        {
          "type": "ADVISORY",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-36401"
        },
        {
          "type": "WEB",
          "url": "https://github.com/geotools/geotools/pull/4797"
        },
        {
          "type": "WEB",
          "url": "https://github.com/Warxim/CVE-2022-41852?tab=readme-ov-file#workaround-for-cve-2022-41852"
        },
        {
          "type": "PACKAGE",
          "url": "https://github.com/geoserver/geoserver"
        },
        {
          "type": "WEB",
          "url": "https://osgeo-org.atlassian.net/browse/GEOT-7587"
        }
      ],
      "affected": [
        {
          "package": {
            "name": "org.geoserver.web:gs-web-app",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver.web/gs-web-app"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "2.24.0"
                },
                {
                  "fixed": "2.24.4"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-6jj6-gm7p-fcvv/GHSA-6jj6-gm7p-fcvv.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver:gs-wfs",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver/gs-wfs"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "2.24.0"
                },
                {
                  "fixed": "2.24.4"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-6jj6-gm7p-fcvv/GHSA-6jj6-gm7p-fcvv.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver:gs-wms",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver/gs-wms"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "2.24.0"
                },
                {
                  "fixed": "2.24.4"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-6jj6-gm7p-fcvv/GHSA-6jj6-gm7p-fcvv.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver.web:gs-web-app",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver.web/gs-web-app"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "2.25.0"
                },
                {
                  "fixed": "2.25.2"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-6jj6-gm7p-fcvv/GHSA-6jj6-gm7p-fcvv.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver:gs-wfs",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver/gs-wfs"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "2.25.0"
                },
                {
                  "fixed": "2.25.2"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-6jj6-gm7p-fcvv/GHSA-6jj6-gm7p-fcvv.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver:gs-wms",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver/gs-wms"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "2.25.0"
                },
                {
                  "fixed": "2.25.2"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-6jj6-gm7p-fcvv/GHSA-6jj6-gm7p-fcvv.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver.web:gs-web-app",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver.web/gs-web-app"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "0"
                },
                {
                  "fixed": "2.23.6"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-6jj6-gm7p-fcvv/GHSA-6jj6-gm7p-fcvv.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver:gs-wfs",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver/gs-wfs"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "0"
                },
                {
                  "fixed": "2.23.6"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-6jj6-gm7p-fcvv/GHSA-6jj6-gm7p-fcvv.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver:gs-wms",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver/gs-wms"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "0"
                },
                {
                  "fixed": "2.23.6"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-6jj6-gm7p-fcvv/GHSA-6jj6-gm7p-fcvv.json"
          }
        }
      ],
      "schema_version": "1.6.0",
      "severity": [
        {
          "type": "CVSS_V3",
          "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
        },
        {
          "type": "CVSS_V4",
          "score": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N"
        }
      ]
    },
    {
      "id": "GHSA-cqpc-x2c6-2gmf",
      "summary": "Unsecured WMS dynamic styling sld=<url> parameter affords blind unauthenticated SSRF",
      "details": "### Summary\n\nThe WMS specification defines an ``sld=<url>`` parameter for GetMap, GetLegendGraphic and GetFeatureInfo operations for user supplied \"dynamic styling\".  Enabling the use of dynamic styles, without also configuring URL checks, provides the opportunity for Service Side Request Forgery.\n \nIt is possible to use this for \"Blind SSRF\" on the WMS endpoint to steal NetNTLMv2 hashes via file requests to malicious servers.\n\n### Details\n\nThis vulnerability requires:\n\n* WMS Settings dynamic styling being enabled\n* Security URL checks to be disabled, or to be enabled and allowing ``file:\\\\*`` access\n\n### Impact\n\nThis vulnerability can be used to steal user NetNTLMv2 hashes which could be relayed or cracked externally to gain further access.\n\n### Mitigation\n\nThe ability to reference an external URL location is defined by the WMS standard GetMap, GetFeatureInfo and GetLegendGraphic operations. These operations are defined by an Industry and International standard and cannot be redefined by the GeoServer application in isolation.\n\nTo disable dynamic styling on GeoServer 2.10.3 and GeoServer 2.11.1:\n\n1. Navigate to **Services > WMS Settings** page\n2. Locate **Dynamic styling** heading\n3. Select the **Disable usage of SLD and SLD_BODY parameters in GET requests and user styles in POST** checkbox.\n\n### Resolution\n\nTo allow dynamic styling safely on GeoServer 2.22.5 and GeoServer 2.23.2:\n\n1. Navigate to **Security > URL Checks**\n2. Enable **URL Checks are enabled** setting\n3. Check the user manual for [examples](https://docs.geoserver.org/latest/en/user/security/urlchecks.html#example-regex-patterns) of how to trust specific locations:\n   ``^https://styles\\.server\\.net/cartography/.*$``\n4. Enable dynamic styling on the **Services > WMS Settings** page, deselect the **Disable usage of SLD and SLD_BODY parameters in GET requests and user styles in POST** checkbox.\n\nUse of dynamic styling safely is on by default in GeoServer 2.24.0.\n\n### References\n\n* [Disabling usage of dynamic styling in GetMap, GetFeatureInfo and GetLegendGraphic requests](https://docs.geoserver.org/latest/en/user/services/wms/webadmin.html#disabling-usage-of-dynamic-styling-in-getmap-getfeatureinfo-and-getlegendgraphic-requests)\n* [URL Checks](https://docs.geoserver.org/latest/en/user/security/urlchecks.html)",
      "aliases": [
        "CVE-2023-41339"
      ],
      "modified": "2024-03-06T23:57:16Z",
      "published": "2023-10-24T19:20:34Z",
      "database_specific": {
        "github_reviewed_at": "2023-10-24T19:20:34Z",
        "github_reviewed": true,
        "severity": "MODERATE",
        "cwe_ids": [
          "CWE-918"
        ],
        "nvd_published_at": "2023-10-25T18:17:30Z"
      },
      "references": [
        {
          "type": "WEB",
          "url": "https://github.com/geoserver/geoserver/security/advisories/GHSA-cqpc-x2c6-2gmf"
        },
        {
          "type": "ADVISORY",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2023-41339"
        },
        {
          "type": "PACKAGE",
          "url": "https://github.com/geoserver/geoserver"
        },
        {
          "type": "WEB",
          "url": "https://github.com/geoserver/geoserver/releases/tag/2.22.5"
        },
        {
          "type": "WEB",
          "url": "https://github.com/geoserver/geoserver/releases/tag/2.23.2"
        }
      ],
      "affected": [
        {
          "package": {
            "name": "org.geoserver:gs-wms",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver/gs-wms"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "0"
                },
                {
                  "fixed": "2.22.5"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-cqpc-x2c6-2gmf/GHSA-cqpc-x2c6-2gmf.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver:gs-wms",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver/gs-wms"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "2.23.0"
                },
                {
                  "fixed": "2.23.2"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-cqpc-x2c6-2gmf/GHSA-cqpc-x2c6-2gmf.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver.web:gs-web-app",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver.web/gs-web-app"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "0"
                },
                {
                  "fixed": "2.22.5"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-cqpc-x2c6-2gmf/GHSA-cqpc-x2c6-2gmf.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver.web:gs-web-app",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver.web/gs-web-app"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "2.23.0"
                },
                {
                  "fixed": "2.23.2"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2023/10/GHSA-cqpc-x2c6-2gmf/GHSA-cqpc-x2c6-2gmf.json"
          }
        }
      ],
      "schema_version": "1.6.0",
      "severity": [
        {
          "type": "CVSS_V3",
          "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
        }
      ]
    },
    {
      "id": "GHSA-j59v-vgcr-hxvf",
      "summary": " GeoServer's Server Status shows sensitive environmental variables and Java properties",
      "details": "GeoServer's Server Status page and REST API (at `/geoserver/rest/about/status`) lists *all* environment variables and Java properties to *any* GeoServer user with administrative rights as part of those modules' status message.\n\nThese variables/properties can also contain sensitive information, such as database passwords or API keys/tokens, for example:\n\n* Data stores defined with [parameterized catalog settings][catalog] (`-DALLOW_ENV_PARAMETRIZATION=true`) which need a password or access key.\n\n* GeoServer's official Docker image [uses environment variables to configure PostgreSQL JNDI resources, including credentials][docker-jndi] (`POSTGRES_HOST`, `POSTGRES_USERNAME`, `POSTGRES_PASSWORD`)\n\nAdditionally, many community-developed GeoServer container images `export` other credentials from their start-up scripts as environment variables to the GeoServer (`java`) process, such as:\n\n* GeoServer `admin` and master (`root`) passwords\n\n* Tomcat management application password\n\n* HTTPS/TLS certificate key store password\n\n* AWS S3 bucket access keys\n\nThe precise scope of the issue depends on which container image is used and how it is configured.\n\n> [!NOTE]\n> Some container images allow passing secrets as files (eg: `POSTGRES_PASSWORD_FILE`), or randomly generating passwords on start-up. While this is promoted as best-practice[^secret-files], if its start-up script [`export`s these as environment variables][bash-export] to GeoServer, they are **also** impacted by this issue.\n\n[bash-export]: https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html#index-export\n[catalog]: https://docs.geoserver.org/latest/en/user/datadirectory/configtemplate.html\n[docker-jndi]: https://github.com/geoserver/docker/blob/master/README.md#how-to-enable-a-postgresql-jndi-resource\n\n### Impact\n\nThe “about status” API endpoint (at `/geoserver/rest/about/status`) which powers the Server Status page is only available to administrators.\n\nDepending on the operating environment, administrators might have legitimate access to credentials in other ways, but this issue defeats more sophisticated controls (like break-glass access to secrets or role accounts).\n\nBy default, GeoServer only allows same-origin authenticated API access. This limits the scope for a third-party attacker to use an administrator’s credentials to gain access to credentials (ie: requires XSS).\n\nWe were unable to determine any other conditions under which the GeoServer REST API may be available more broadly.\n\n### Fixes / remediation\n\nGeoServer 2.24.4 and 2.25.1 hide **all** environment variables and Java system properties *by default*, with *no further action required by GeoServer administrators*.\n\n[There are new settings to allow an administrator to display these again][showing] – effectively **reverting** this security fix. We strongly recommend administrators leave these settings as-is, and use alternative mechanisms to access environment variables (instructions below).\n\nIf you're using GeoServer in a container runtime (such as Docker or Kubernetes) or from some other distributor's packages, you'll need to wait for the maintainer to update the version of GeoServer used in their image.\n\n> [!WARNING]\n> If you run GeoServer with [parameterized catalog settings][catalog] (`-DALLOW_ENV_PARAMETRIZATION=true`), a GeoServer administrator could use this to access any environment variable or Java property by including it in some field which is rendered by the UI (such as the description field), **even with this fix**.\n\n[showing]: https://docs.geoserver.org/latest/en/user/production/config.html#showing-environment-variables-and-java-system-properties\n\n### Advice for container / Docker image maintainers\n\nUpdate container images to use GeoServer 2.24.4 or 2.25.1 to get the bug fix.\n\nPlease leave environment variables and Java system properties hidden by default. If you provide the option to re-enable it, [communicate the impact and risks][showing] so that users can make an informed choice.\n\nContainer images should practice \"defence in depth\", to limit the impact when it is configured to show environment variables and/or properties:\n\n* Pass secrets to the container as either:\n\n  * files which are only readable by the GeoServer process/UID, or,\n  * references (identifiers) to a secret stored in a cloud provider's metadata or secret management service\n\n* Pass secrets to GeoServer by generating configuration files as part of your start-up scripts, rather than passing variables/properties or relying on [parameterized catalog settings][catalog].\n\n* Ensure any configuration files with secrets are not readable by other users.\n\n* Clear all environment variables which contain secrets _before_ starting GeoServer.\n\n  _Alternatively:_ start up GeoServer with *only* the environment variables it needs, and no secrets.\n\n* **Don't** pass secrets as command-line flags – these are shown in `ps` to all users!\n\n### Alternatives for displaying GeoServer's environment variables\n\n* **On Linux,** you can get all environment variables [set at _start-up time_][linux-environ] for a running process with:\n\n  ```sh\n  tr '\\0' '\\n' < /proc/${GEOSERVER_PID}/environ\n  ```\n\n* **On Windows,** [SysInternals' Process Explorer][proc-exp] can show running processes' environment variables.\n\n* Current versions of **macOS** do not allow arbitrary access to other running processes' environment variables. Disabling these restrictions (on a macOS level) would significantly reduce the overall security of the system.\n\n[linux-environ]: https://unix.stackexchange.com/a/70636\n[proc-exp]: https://learn.microsoft.com/en-us/sysinternals/downloads/process-explorer\n\n[^secret-files]: [Docker Compose: How to use secrets in Docker Compose](https://docs.docker.com/compose/use-secrets/), [Docker Swarm: Build support for Docker Secrets into your images](https://docs.docker.com/engine/swarm/secrets/#build-support-for-docker-secrets-into-your-images)",
      "aliases": [
        "CVE-2024-34696"
      ],
      "modified": "2024-07-01T19:42:51.849750Z",
      "published": "2024-07-01T19:20:57Z",
      "database_specific": {
        "github_reviewed_at": "2024-07-01T19:20:57Z",
        "github_reviewed": true,
        "severity": "MODERATE",
        "cwe_ids": [
          "CWE-200"
        ],
        "nvd_published_at": "2024-07-01T15:15:16Z"
      },
      "references": [
        {
          "type": "WEB",
          "url": "https://github.com/geoserver/geoserver/security/advisories/GHSA-j59v-vgcr-hxvf"
        },
        {
          "type": "ADVISORY",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-34696"
        },
        {
          "type": "PACKAGE",
          "url": "https://github.com/geoserver/geoserver"
        }
      ],
      "affected": [
        {
          "package": {
            "name": "org.geoserver.web:gs-web-app",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver.web/gs-web-app"
          },
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-j59v-vgcr-hxvf/GHSA-j59v-vgcr-hxvf.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver.web:gs-web-app",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver.web/gs-web-app"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "2.25.0"
                },
                {
                  "fixed": "2.25.1"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-j59v-vgcr-hxvf/GHSA-j59v-vgcr-hxvf.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver:gs-main",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver/gs-main"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "2.10.0"
                },
                {
                  "fixed": "2.24.4"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-j59v-vgcr-hxvf/GHSA-j59v-vgcr-hxvf.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver:gs-main",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver/gs-main"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "2.25.0"
                },
                {
                  "fixed": "2.25.1"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-j59v-vgcr-hxvf/GHSA-j59v-vgcr-hxvf.json"
          }
        }
      ],
      "schema_version": "1.6.0",
      "severity": [
        {
          "type": "CVSS_V3",
          "score": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:N"
        }
      ]
    },
    {
      "id": "GHSA-jhqx-5v5g-mpf3",
      "summary": "Classpath resource disclosure in GWC Web Resource API on Windows / Tomcat",
      "details": "### Impact\n\nIf GeoServer is deployed in the Windows operating system using an Apache Tomcat web application server, it is possible to bypass existing input validation in the GeoWebCache ByteStreamController class and read arbitrary classpath resources with specific file name extensions.\n\nIf GeoServer is also deployed as a web archive using the data directory embedded in the geoserver.war file (rather than an external data directory), it will likely be possible to read specific resources to gain administrator privileges.  However, it is very unlikely that production environments will be using the embedded data directory since, depending on how GeoServer is deployed, it will be erased and re-installed (which would also reset to the default password) either every time the server restarts or every time a new GeoServer WAR is installed and is therefore difficult to maintain. An external data directory will always be used if GeoServer is running in standalone mode (via an installer or a binary).\n\n### Patches\n\nhttps://github.com/GeoWebCache/geowebcache/pull/1211\n\n### Workarounds\n\nChange environment:\n\n* Change from Windows operating system. This vulnerability depends on Windows file paths so Linux and Mac OS are not vulnerable.\n* Change from Apache Tomcat application server. Jetty and WildFly are confirmed to not be vulnerable. Other application servers have not been tested and may be vulnerable.\n\nDisable anonymous access to the embeded GeoWebCache administration and status pages:\n\n1. Navigate to **Security > Authentication** Page\n2. Locate **Filter Chains** heading\n3. Select the ``web`` filter filter chain (ant pattern ``/web/**,/gwc/rest/web/**,/``)\n4. Remove ``,/gwc/rest/web/**`` from the pattern (so that ``/web/**,/`` is left).\n5. Save the changes\n\n### References\n\n* CVE-Pending\n",
      "modified": "2024-07-01T19:42:51.779560Z",
      "published": "2024-07-01T19:24:04Z",
      "database_specific": {
        "github_reviewed_at": "2024-07-01T19:24:04Z",
        "github_reviewed": true,
        "severity": "HIGH",
        "cwe_ids": [
          "CWE-22"
        ],
        "nvd_published_at": "2024-07-01T14:15:05Z"
      },
      "references": [
        {
          "type": "WEB",
          "url": "https://github.com/geoserver/geoserver/security/advisories/GHSA-jhqx-5v5g-mpf3"
        },
        {
          "type": "ADVISORY",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-24749"
        },
        {
          "type": "WEB",
          "url": "https://github.com/GeoWebCache/geowebcache/pull/1211"
        },
        {
          "type": "WEB",
          "url": "https://github.com/GeoWebCache/geowebcache/commit/c7f76bd8a1d67c3b986146e7a5e0b14dd64a8fef"
        },
        {
          "type": "PACKAGE",
          "url": "https://github.com/geoserver/geoserver"
        }
      ],
      "affected": [
        {
          "package": {
            "name": "org.geoserver.web:gs-web-app",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver.web/gs-web-app"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "0"
                },
                {
                  "fixed": "2.23.5"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-jhqx-5v5g-mpf3/GHSA-jhqx-5v5g-mpf3.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver.web:gs-web-app",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver.web/gs-web-app"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "2.24.0"
                },
                {
                  "fixed": "2.24.3"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-jhqx-5v5g-mpf3/GHSA-jhqx-5v5g-mpf3.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver:gs-gwc",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver/gs-gwc"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "0"
                },
                {
                  "fixed": "2.23.5"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-jhqx-5v5g-mpf3/GHSA-jhqx-5v5g-mpf3.json"
          }
        },
        {
          "package": {
            "name": "org.geoserver:gs-gwc",
            "ecosystem": "Maven",
            "purl": "pkg:maven/org.geoserver/gs-gwc"
          },
          "ranges": [
            {
              "type": "ECOSYSTEM",
              "events": [
                {
                  "introduced": "2.24.0"
                },
                {
                  "fixed": "2.24.3"
                }
              ]
            }
          ],
          "database_specific": {
            "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2024/07/GHSA-jhqx-5v5g-mpf3/GHSA-jhqx-5v5g-mpf3.json"
          }
        }
      ],
      "schema_version": "1.6.0",
      "severity": [
        {
          "type": "CVSS_V3",
          "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
        }
      ]
    }
  ]
}